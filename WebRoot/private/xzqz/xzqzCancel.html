<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>$!app_name</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type='text/javascript'>
        var CONTEXTPATH = '${base}';
        var stylePath = '$!stylename';
    </script>
    <link href="${base}/private/ratifyFollow/css/$!stylename/style.css" rel="stylesheet" type="text/css" />

    <script src="${base}/include/js/main.js"></script>
    <script src="${base}/include/js/string.js"></script>
    <!--<link href="${base}/include/css/themes/gray/easyui.css" rel="stylesheet" type="text/css" />-->
    <script src="${base}/include/js/jquery.easyui.min.js"></script>
    <link href="${base}/include/controls/my97/skin/WdatePicker.css" rel="stylesheet" type="text/css"/>
    <script language="javascript" type="text/javascript" src="${base}/include/controls/my97/WdatePicker.js"></script>
    <script src="${base}/include/js/ajaxfileupload.js"></script>
    <script src="${base}/js/util/preview.js"></script>
    <script>
        function ht(){
            $("#hideDIV").attr("style","");
        }
        
        function add(){
            var d = new Dialog("add");
            d.Width = 850;
            d.Height = 400;
            d.Title = "添加项目";
            d.URL = "${base}/private/zjgl/sxcj/addht";
            d.OKEvent = function() {
                $D.close();
            }
            d.show();
            }
        
        //选择行政处罚类型，弹出失信行为
        function toFindxw(){
            var xy_type = $("#xzcf_type").val();
            if(xy_type == "" || xy_type == null){
                Dialog.alert("行政处罚类型不能为空");
                return;
            }
            //添加行政处罚类失信行为
            $.ajax({
                type: "post",
                url : "${base}/private/xzcf/sxxwAjax?xy_type="+xy_type ,
                dataType : "json",
                success : function (res) {
                    var xw = "";
                    var old_name = "";
                    $.each(res,function(n,array){
                        if(old_name != array.sxxw){
                            old_name = array.sxxw ;
                            xw += "<input style='vertical-align: middle;' type='checkbox' id='checkbox"+array.id+"' name='checkbox' value='"+array.id+"' onclick='checkboxOnclick();'/><span>"+array.sxxw+"</span></br>";
                        }
                    })
                    $("#xw_td").html(xw);
                }
            });
        }
        
        function checkboxOnclick(){
            var Source = window.event.srcElement;//指向触发事件的元素
            //var b = Source.value;
            //alert("tagName : " + Source.tagName + "\n" + "value : " + Source.value );
            //var radio_value = $("input[type=radio]").val();
            var arr_checkbox = document.getElementsByName("checkbox");
            for(var i=0;i<arr_checkbox.length;i++){
                 if($("input[name='checkbox']:checked").length > 1){
//                   Dialog.alert("此处只能选择一项");
                     $("input[name='checkbox']").attr("checked",false);
                     //对当前点击的checkbox置空
                     Source.checked = true;
                 }
                 //checkbox不为空
                 if($("input[name='checkbox']:checked").length == 0){
                      Source.checked = true;
                 }
                 var a = arr_checkbox[i].value;
                 if(arr_checkbox[i].checked == true){
                     text = $("input[name=checkbox]:checked").next().text();
                     $("#au").text(text);
                     $("#qxtr").show();
                     addqx(a);
                 }
                 if(arr_checkbox[i].checked == false){
                      $("#span_qx"+a+"").html("");
                 }
            }
        }
        //添加失信情形
        function addqx(id){
            $.ajax({
                type: "post",
                url : "${base}/private/sxcj/sxqxAjax?sxxwid="+id ,
                dataType : "json",
                success : function (res) {
                    var qx = "";
                    var old_name = "";
                    $.each(res,function(n,array){
                        if(old_name != array.sxqx){
                            old_name = array.sxqx ;
                            qx += "<span id='span_qx"+id+"'><input style='vertical-align: middle;' type='checkbox' id='checkbox_qx"+id+"' name='checkbox_qx' onclick='addcs();' value='"+array.id+"'/><span>"+array.sxqx+"</span></br></span>";
                        }
                    })
                    $("#qx_td").html(qx);
                }
            });
        }
        
        //添加惩戒措施
        function addcs(){
            var Source = window.event.srcElement;//指向触发事件的元素
            var id = Source.value;//获取当前点击框value
            var bz = $("#bz1").val();
            
            var arr_checkbox = document.getElementsByName("checkbox_qx");
            //单选 
            for(var i=0;i<arr_checkbox.length;i++){
                 var a = arr_checkbox[i].value;
                 if($("input[name=checkbox_qx]:checked").length > 1){
                    $("input[name='checkbox_qx']").attr("checked",false);
                    //对当前点击的checkbox置空
                    Source.checked = true;
                 }
            }
            for(var i=0;i<arr_checkbox.length;i++){
                if(arr_checkbox[i].checked == true){
                    var text = "";//单选存储
                    text = $("input[name=checkbox_qx]:checked").next().text();
                    $("#sxqx_name").val(text);
                    $.ajax({
                        type: "post",
                        url : "${base}/private/sxcj/cjcsAjax?sxqxid="+id,
                        dataType : "json",
                        data : $("#form1").serialize(),
                        success : function (res) {
                            var cs = "";
                            $.each(res,function(n,array){
                                cs += "<span id='span_cs"+id+"'><input style='vertical-align: middle;' type='checkbox' id='checkbox_cs"+id+"' name='checkbox_cs' value='"+array.id+"'/>"+array.cjcs+"</br></span>";
                            })
                            $("#cs_td").html(cs);
                        }
                    });
                    $.ajax({
                        type: "post",
                        url : "${base}/private/sxcj/yjAjax?id="+id ,
                        dataType : "json",
                        success : function (res) {
                            var yj = "";
                            var yj_name = "";
                            $.each(res,function(n,array){
                                if(yj_name != array.name) {
                                    yj_name = array.name;
                                    yj += array.yj;
                                }
                            })
                            $("#yj_textarea").text(yj);
                        }
                    });
                }
                if(arr_checkbox[i].checked == false){
                    $("#span_cs"+a+"").html("");
                }
            }
            $("#cstr").show();
            $("#yjtr").show();
        }
        
        var xyztMap = $xyztMap;
        //添加信用主体    
        function toAddfr(){
            var ctype = 1;
            var d = new Dialog("Addfr");
            d.Width = 900;
            d.Height = 450;
            d.Title = "添加信用主体";
            d.URL = "${base}/private/jlxx/toAddfr?ctype="+ctype;
            d.OKEvent = function(){
                if($DW.doSave()){
                    var ids = $DW.$("#checkids_id").val();
                    var names = $DW.$("#checkids_name").val();
                    var types = $DW.$("#checkids_type").val();
                    $("#xyzt_name").val(names);
                    $("#xyzt_id").val(ids);
                    $("#xyzt_type").val(xyztMap[types]);
                    $D.close();
                }
            }
            d.show();
        }
        
       /* var ztMap = $ztHt;
        //选择失信惩戒中的信用主体
        function toAddsxcj(){
            var xy_type = $("#xzcf_type").val();
            if(xy_type == "" || xy_type == null){
                Dialog.alert("请先选择行政处罚类型！");
                return;
            }
            var d = new Dialog("Addfr");
            d.Width = 900;
            d.Height = 450;
            d.Title = "添加信用主体";
            d.URL = "${base}/private/xzcf/toAddfr?xy_type="+xy_type;
            d.OKEvent = function(){
                if($DW.doSave()){
                    var ids = $DW.$("#checkids_id").val();
                    var names = $DW.$("#checkids_name").val();
                    var types = $DW.$("#checkids_type").val();
                    var contract_id = $DW.$("#contract_id").val();
                    //alert("xyzt_id:"+ids+""+"contract_id:"+contract_id);
                    $("#xyzt_name").val(names);
                    $("#xyzt_id").val(ids);
                    $("#xyzt_type").val(ztMap[types]);
                    $("#contract_id").val(contract_id);
                    $("#xwtr").show();
                    $D.close();
                    findHtmc(contract_id);
                }
            }
            d.show();
        }*/
        
        //查询合同名称
        function findHtmc(id){
            if(id == "" || id == null){
                return;
            }
            var xy_type = $("#xzcf_type").val();
            jQuery.ajax({
                type: 'POST',
                url : "${base}/private/xzcf/tofindHtmc?htid="+id+"&xy_type="+xy_type,
                success : function (res) {
                    $("#xm_name").val(res);
            },
                fail : function(res) {
                    Dialog.alert("系统错误?!");
                }
            });
        }
        
        //添加操作
        function doSave(){
            if(Verify.hasError()){
                return ;
            }
            jQuery.ajax({
                type: 'POST',
                url : "${base}/private/xzqz/revoke" ,
                data : $("#form1").serialize(),
                success : function (res) {
                    if(res == "true"){
                        Dialog.alert("撤销成功！",function(){
                        	refreshloadDataTab();
                        });
                    }else{
                        Dialog.alert("撤销成功！");
                    }
                    return false;
                },
                fail : function(res) {
                    Dialog.alert("系统错误?!");
                }
            });
        }
        
        function setFileList(filePath,fileName,fileSize){
            $("#file_list").html("&nbsp;<a href='${base}/"+filePath+"' >"+fileName+"("+fileSize+"MB)</a><br />");
        }
        
        window.onload = function(){
            
            checkboxOnclick();
            $("#xwtr").hide();
            $("#qxtr").hide();
            $("#cstr").hide();
            $("#yjtr").hide();
        }
    </script>
</head>
<body leftmargin="0" topmargin="0" class="easyui-layout">
<form name='form1' id="form1" method='post'
      action="${base}/private/slzx/slj_info/add">
    <input type="hidden" name="issue" id="issue" value="$!xzqz.issue"/>
    <div style="display:none">
        <input type="hidden" name="file_html" id="file_html"  value="$!xzqz.file_html"/>
    </div>
    <input type="hidden" id="xzcf_zt" name="xzcf_zt" value="$!xzqz.xzcf_zt"/>
    <input type="hidden" id="create_date" name="create_date" value="$!xzqz.create_date"/>
    <input type="hidden" id="unitid" name="unitid" value="$!xzqz.unitid"/>
    <input type="hidden" id="actor" name="actor" value="$!xzqz.actor"/>
    <input type="hidden" id="id" name="id" value="$!xzqz.id"/>
    <input type="hidden" id="xyzt_id" name="xyzt_id" value="$!xzqz.xyzt_id"/>
    <input type="hidden" id="is_warn" name="is_warn" value="$!xzqz.is_warn"/>
    
    <div region="center" border="false" style="width: 100%; height: 100%; padding: 0px 10px 10px;">
        <table width="98%" border="0" align="center" cellpadding="0"
               cellspacing="0" class="table_auto margin_top15 table_titlebk">
            <tr>
                <td class="table_title" align="center">
                    行政强制信息
                </td>
            </tr>
        </table>
        <table width="98%" border="0" align="center" cellpadding="0"  cellspacing="0" class="table_auto table_nrbk">
            <tr>
                <td valign="top" class="padding10">
                    <table width="100%" border="0" cellpadding="0" cellspacing="3">
                        
                        <tr>
                            <td align="right" width="60">信用主体：</td>
                            <td width="210">$!xyzt.name</td>
                             <td align="right" width="50">信用主体类型：</td>
                            <td>$!xyztMap.get("$!xyzt.type")</td>
                        </tr>
                        
                        <tr>
                            <td align="right" width="80">案件名称：</td>
                            <td algin="left" width="240">$!xzqz.aj_name</td>
                            <td align="right" width="60" valign="top">强制机关全称：</td>
                            <td >$!xzqz.jg_unitid</td>
                        </tr>
                        
                        <tr>
                            <td align="right" width="120">决定书文号：</td>
                            <td width="200">$!xzqz.jds_code</td>
                            <td align="right" width="100" >处罚期限：</td>
                            <td width="100" colspan="4">$!xzqz.start_date 至  $!xzqz.end_date</td>
                        </tr>
                        
                        <tr>
                           <td align="right" valign="top">行政强制理由：</td>
                           <td colspan="4">
                               <textarea id="reason" name="reason" cols="110" rows="3" readonly="readonly" verify="强制理由|NotNull">$!xzqz.reason</textarea>
                           </td> 
                        </tr>
                        
                        <tr>
                           <td align="right" valign="top">行政强制依据：</td>
                           <td colspan="4">
                               <textarea id="reply" name="reply" cols="110" rows="3" readonly="readonly" verify="行政强制依据|NotNull">$!xzqz.reply</textarea>
                           </td>
                        </tr>
                        
                        <tr>
                           <td align="right" valign="top">行政强制结论：</td>
                           <td colspan="4">
                               <textarea id="conslusion" name="conslusion" cols="110" readonly="readonly" rows="3" verify="行政强制结论|NotNull">$!xzqz.conslusion</textarea>
                           </td> 
                        </tr>
                        
                        <tr>
                           <td align="right" valign="top">执行情况：</td>
                           <td colspan="4">
                               <textarea id="zxqk" name="zxqk" cols="110" rows="3" readonly="readonly" verify="执行情况|NotNull">$!xzqz.zxqk</textarea>
                           </td> 
                        </tr>
                        
                        <!--
                        <tr>
                            <td align="right" width="100" >处罚履行时间：</td>
                            <td width="100">
                                <input class="Wdate" onclick="WdatePicker();" name="cflx_date" id="cflx_date" size="20" maxlength="50" verify="处罚履行时间|NotNull"></input><span style="color:red">*</span>
                            </td>
                        </tr>
                        -->
                        
                        <tr>
                            <td align="right" width="120">附件：</td>
                            <td>
                                #if($xzqz.file_html)
                                    $!xzqz.file_html
                                #else
                                                                        无
                                #end 
                            </td>
                        </tr>
                        
                        <tr>
                            <td align="right" width="60" valign="top">撤销内容：</td>
                            <td width="150" colspan="4">
                            	<textarea id="note" name="note" cols="110" rows="3" verify="撤销内容|NotNull"></textarea>
                            	<span style="color:red">*</span>
                            </td>
                        </tr> 
                        
                        <tr>
                            <td align="right" width="60" valign="top">撤销原因：</td>
                            <td width="150" colspan="4">
                            	<textarea id="u_reason" name="u_reason" cols="110" rows="3" verify="撤销原因|NotNull"></textarea>
                            	<span style="color:red">*</span>
                            </td>
                        </tr> 
                        
                        <tr>
                            <td align="right" width="60" valign="top">撤销依据：</td>
                            <td width="150" colspan="4">
                            	<textarea id="basis" name="basis" cols="110" rows="3" verify="撤销依据|NotNull"></textarea>
                            	<span style="color:red">*</span>
                            </td>
                        </tr> 
                        
                        <!--<tr>
                             <td align="right" valign="top" width="80">上传附件：</td>
                             <td colspan="4">
                                 <input name="fjurl" id="filepath" type="hidden">
                                 <input name="fjmc" id="filename" type="hidden" maxlength="50">
                                 <span class="attachement" style="padding:2px;display:inline-block;" name="editable-input">
                                     <input type="text" name="fjname" class="inputText"/>
                                     <input name="fj_filename" type="hidden"/>
                                     <input name="fj_filepath" type="hidden"/>
                                     <input name="fj_filesize" type="hidden"/>
                                     <button class="btn-text btn-attachement" onclick="loadFileClick(this);" type="button" fileinputname="fj" id="fj_button">选择</button>
                                 </span>
                                 <span style="color:gray;font-size:10px;"></span>
                             </td>
                        </tr>-->
                        
                    </table>
                </td>
            </tr>
        </table>
        <div region="south" border="false"
             style="overflow: hidden; padding: 10px 10px 0px 10px">
            <table width="98%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td align="center">
                        <input class="button" type="button" name="btnOk" value="确认"
                               onclick="doSave()" />
                        <input class="button" type="button" name="btnOk" value="关闭"
                               onclick="window.close();" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
</form>
</body>
</html>