<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>$!app_name</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type='text/javascript'>
        var CONTEXTPATH = '${base}';
        var stylePath = '$!stylename';
    </script>
	<link rel="stylesheet" type="text/css" href="${base}/include/css/page.css"/>
    <link href="${base}/private/ratifyFollow/css/$!stylename/style.css" rel="stylesheet" type="text/css" />
    <script src="${base}/include/js/main.js"></script>
    <script src="${base}/include/js/string.js"></script>
    <!--<link href="${base}/include/css/themes/gray/easyui.css" rel="stylesheet" type="text/css" />-->
    <script src="${base}/include/js/jquery.easyui.min.js"></script>
    <link href="${base}/include/controls/my97/skin/WdatePicker.css" rel="stylesheet" type="text/css"/>
    <script language="javascript" type="text/javascript" src="${base}/include/controls/my97/WdatePicker.js"></script>
    <script src="${base}/include/js/ajaxfileupload.js"></script>
    <script src="${base}/js/util/preview.js"></script>
    <script>
    function customHeightSet(){			
    	var otherH_1	=jQuery(".pageBtnarea").outerHeight() + parseInt($(".pageM").css("paddingTop")) + parseInt($(".pageM").css("paddingBottom"));
    	var pageH	=document.documentElement.clientHeight;
    	jQuery("#pageScroll").height(pageH-otherH_1);
    }
    jQuery(document).ready(function(){
    	customHeightSet();
    	appendDiv();
    });
    window.onload = function(){
    	customHeightSet();			
    }
    window.onresize = function(){
    	customHeightSet();
     }
    
        function ht(){
            $("#hideDIV").attr("style","");
        }
        
        function add(){
            var d = new Dialog("add");
            d.Width = 850;
            d.Height = 400;
            d.Title = "添加项目";
            d.URL = "${base}/private/zjgl/sxcj/addht";
            d.OKEvent = function() {
                $D.close();
            }
            d.show();
            }
        
        //选择行政处罚类型，弹出失信行为
        function toFindxw(){
            var xy_type = $("#xzcf_type").val();
            if(xy_type == "" || xy_type == null){
                Dialog.alert("行政处罚类型不能为空");
                return;
            }
            //添加行政处罚类失信行为
            $.ajax({
                type: "post",
                url : "${base}/private/xzcf/sxxwAjax?xy_type="+xy_type ,
                dataType : "json",
                success : function (res) {
                    var xw = "";
                    var old_name = "";
                    $.each(res,function(n,array){
                        if(old_name != array.sxxw){
                            old_name = array.sxxw ;
                            xw += "<input style='vertical-align: middle;' type='checkbox' id='checkbox"+array.id+"' name='checkbox' value='"+array.id+"' onclick='checkboxOnclick();'/><span>"+array.sxxw+"</span></br>";
                        }
                    })
                    $("#xw_td").html(xw);
                }
            });
        }
        
        function checkboxOnclick(){
            var Source = window.event.srcElement;//指向触发事件的元素
            //var b = Source.value;
            //alert("tagName : " + Source.tagName + "\n" + "value : " + Source.value );
            //var radio_value = $("input[type=radio]").val();
            var arr_checkbox = document.getElementsByName("checkbox");
            for(var i=0;i<arr_checkbox.length;i++){
                 if($("input[name='checkbox']:checked").length > 1){
//                   Dialog.alert("此处只能选择一项");
                     $("input[name='checkbox']").attr("checked",false);
                     //对当前点击的checkbox置空
                     Source.checked = true;
                 }
                 //checkbox不为空
                 if($("input[name='checkbox']:checked").length == 0){
                      Source.checked = true;
                 }
                 var a = arr_checkbox[i].value;
                 if(arr_checkbox[i].checked == true){
                     text = $("input[name=checkbox]:checked").next().text();
                     $("#au").text(text);
                     $("#qxtr").show();
                     addqx(a);
                 }
                 if(arr_checkbox[i].checked == false){
                      $("#span_qx"+a+"").html("");
                 }
            }
        }
        //添加失信情形
        function addqx(id){
            $.ajax({
                type: "post",
                url : "${base}/private/sxcj/sxqxAjax?sxxwid="+id ,
                dataType : "json",
                success : function (res) {
                    var qx = "";
                    var old_name = "";
                    $.each(res,function(n,array){
                        if(old_name != array.sxqx){
                            old_name = array.sxqx ;
                            qx += "<span id='span_qx"+id+"'><input style='vertical-align: middle;' type='checkbox' id='checkbox_qx"+id+"' name='checkbox_qx' onclick='addcs();' value='"+array.id+"'/><span>"+array.sxqx+"</span></br></span>";
                        }
                    })
                    $("#qx_td").html(qx);
                }
            });
        }
        
        //添加惩戒措施
        function addcs(){
            var Source = window.event.srcElement;//指向触发事件的元素
            var id = Source.value;//获取当前点击框value
            var bz = $("#bz1").val();
            
            var arr_checkbox = document.getElementsByName("checkbox_qx");
            //单选 
            for(var i=0;i<arr_checkbox.length;i++){
                 var a = arr_checkbox[i].value;
                 if($("input[name=checkbox_qx]:checked").length > 1){
                    $("input[name='checkbox_qx']").attr("checked",false);
                    //对当前点击的checkbox置空
                    Source.checked = true;
                 }
            }
            for(var i=0;i<arr_checkbox.length;i++){
                if(arr_checkbox[i].checked == true){
                    var text = "";//单选存储
                    text = $("input[name=checkbox_qx]:checked").next().text();
                    $("#sxqx_name").val(text);
                    $.ajax({
                        type: "post",
                        url : "${base}/private/sxcj/cjcsAjax?sxqxid="+id,
                        dataType : "json",
                        data : $("#form1").serialize(),
                        success : function (res) {
                            var cs = "";
                            $.each(res,function(n,array){
                                cs += "<span id='span_cs"+id+"'><input style='vertical-align: middle;' type='checkbox' id='checkbox_cs"+id+"' name='checkbox_cs' value='"+array.id+"'/>"+array.cjcs+"</br></span>";
                            })
                            $("#cs_td").html(cs);
                        }
                    });
                    $.ajax({
                        type: "post",
                        url : "${base}/private/sxcj/yjAjax?id="+id ,
                        dataType : "json",
                        success : function (res) {
                            var yj = "";
                            var yj_name = "";
                            $.each(res,function(n,array){
                                if(yj_name != array.name) {
                                    yj_name = array.name;
                                    yj += array.yj;
                                }
                            })
                            $("#yj_textarea").text(yj);
                        }
                    });
                }
                if(arr_checkbox[i].checked == false){
                    $("#span_cs"+a+"").html("");
                }
            }
            $("#cstr").show();
            $("#yjtr").show();
        }
        
        var xyztMap = $xyztMap;
        //添加信用主体    
        function toAddfr(){
            var ctype = 1;
            var d = new Dialog("Addfr");
            d.Width = 900;
            d.Height = 450;
            d.Title = "添加信用主体";
            d.URL = "${base}/private/jlxx/toAddfr?ctype="+ctype;
            d.OKEvent = function(){
                if($DW.doSave()){
                    var ids = $DW.$("#checkids_id").val();
                    var names = $DW.$("#checkids_name").val();
                    var types = $DW.$("#checkids_type").val();
                    $("#xyzt_name").val(names);
                    $("#xyzt_id").val(ids);
                    $("#xyzt_type").val(xyztMap[types]);
                    $D.close();
                }
            }
            d.show();
        }
        
       /* var ztMap = $ztHt;
        //选择失信惩戒中的信用主体
        function toAddsxcj(){
            var xy_type = $("#xzcf_type").val();
            if(xy_type == "" || xy_type == null){
                Dialog.alert("请先选择行政处罚类型！");
                return;
            }
            var d = new Dialog("Addfr");
            d.Width = 900;
            d.Height = 450;
            d.Title = "添加信用主体";
            d.URL = "${base}/private/xzcf/toAddfr?xy_type="+xy_type;
            d.OKEvent = function(){
                if($DW.doSave()){
                    var ids = $DW.$("#checkids_id").val();
                    var names = $DW.$("#checkids_name").val();
                    var types = $DW.$("#checkids_type").val();
                    var contract_id = $DW.$("#contract_id").val();
                    //alert("xyzt_id:"+ids+""+"contract_id:"+contract_id);
                    $("#xyzt_name").val(names);
                    $("#xyzt_id").val(ids);
                    $("#xyzt_type").val(ztMap[types]);
                    $("#contract_id").val(contract_id);
                    $("#xwtr").show();
                    $D.close();
                    findHtmc(contract_id);
                }
            }
            d.show();
        }*/
        
        //查询合同名称
        function findHtmc(id){
            if(id == "" || id == null){
                return;
            }
            var xy_type = $("#xzcf_type").val();
            jQuery.ajax({
                type: 'POST',
                url : "${base}/private/xzcf/tofindHtmc?htid="+id+"&xy_type="+xy_type,
                success : function (res) {
                    $("#xm_name").val(res);
            },
                fail : function(res) {
                    Dialog.alert("系统错误?!");
                }
            });
        }
        
        //添加操作
        function doSave(){
            if(Verify.hasError()){
                return ;
            }
            var start_date = $("#start_date").val();
            var end_date = $("#end_date").val();
            var d1 = new Date(start_date); 
            var d2 = new Date(end_date);
            if(d1.getTime() > d2.getTime()){
                Dialog.alert("处罚期限填写有误，请核实！");
                return;
            }
            //添加上传路径html
            var file_list = $("#file_list").html();
            if(file_list == "" || file_list == null){
                $("#file_html").val(encode64($("#span_file").html()));
            }else{
                $("#file_html").val(encode64($("#file_list").html()));
            }
            //alert("file_html:"+$("#file_html").val());
            jQuery.ajax({
                type: 'POST',
                url : "${base}/private/xzqz/updateSave" ,
                data : $("#form1").serialize(),
                success : function (res) {
                    if(res == "true"){
                        Dialog.alert("修改成功！",function(){
                        	refreshloadDataTab();
                        });
                    }else{
                        Dialog.alert("修改失败！");
                    }
                    return false;
                },
                fail : function(res) {
                    Dialog.alert("系统错误?!");
                }
            });
        }
        
        function setFileList(filePath,fileName,fileSize){
            $("#file_list").html("&nbsp;<a href='${base}/"+filePath+"' >"+fileName+"("+fileSize+"MB)</a><br />");
        }
        
        window.onload = function(){
            
            checkboxOnclick();
            $("#xwtr").hide();
            $("#qxtr").hide();
            $("#cstr").hide();
            $("#yjtr").hide();
        }
    </script>
</head>
<body >
<form name='form1' id="form1" method='post' action="${base}/private/slzx/slj_info/add">
    <input type="hidden" name="issue" id="issue" value="$!xzqz.issue"/>
    <div id="file_div" name="file_div" style="display:none">
        <input type="hidden" name="file_html" id="file_html"  value="$!xzqz.file_html"/>
    </div>
    <input type="hidden" id="xzcf_zt" name="xzcf_zt" value="$!xzqz.xzcf_zt"/>
    <input type="hidden" id="create_date" name="create_date" value="$!xzqz.create_date"/>
    <input type="hidden" id="unitid" name="unitid" value="$!xzqz.unitid"/>
    <input type="hidden" id="actor" name="actor" value="$!xzqz.actor"/>
    <input type="hidden" id="id" name="id" value="$!xzqz.id"/>
    <input type="hidden" id="xyzt_id" name="xyzt_id" value="$!xzqz.xyzt_id"/>
    <input type="hidden" id="is_warn" name="is_warn" value="$!xzqz.is_warn"/>
    <input type="hidden" id="xzcf_id" name="xzcf_id" value="$!xzqz.xzcf_id"/>
    
    <div class="pageM editpage" id="pageScroll">
        <table width="100%" border="0" align="center" cellpadding="0"  cellspacing="0" class="table_auto margin_top15 table_titlebk ">
            <tr>
                <td class="table_title" align="center">
                                                       行政强制信息
                </td>
            </tr>
        </table>
        <div class="conBody">
			<table width="100%" border="0" cellspacing="0" cellpadding="0"  class="tableEdits">
				<colgroup>
					<col width="10%" />
					<col width="40%" />
					<col width="10%" />
					<col width="40%" />
				</colgroup>
				<tr>
					<th>信用主体：</th>
					<td  >$!xyzt.name</td>
					<th>信用主体类型：</th>
					<td>$!xyztMap.get("$!xyzt.type")</td>
				</tr>

				<tr>
					<th>强制执行机关全称：</th>
					<td>
                        <input type="text" id="jg_unitid" name="jg_unitid" value="$!xzqz.jg_unitid" verify="强制机关全称|NotNull" />
						<span style="color: red">*</span>
					</td>
					<th>决定书文号：</th>
					<td  >
						<input type="text" name="jds_code" readonly="readonly" id="jds_code" size="20" maxlength="40" value="$!xzqz.jds_code" verify="行政处罚决定书文号|NotNull" /> 
						<span style="color: red">*</span>
					</td>
				<!-- 	<th>处罚期限：</th>
					<td  >
						<input class="Wdate" onclick="WdatePicker();" name="start_date" id="start_date" size="12" maxlength="50" value="$!xzqz.start_date" verify="处罚开始时间|NotNull" />
						&nbsp;至&nbsp;
					    <input class="Wdate" onclick="WdatePicker();" name="end_date" id="end_date" size="12" maxlength="50" value="$!xzqz.end_date" verify="处罚结束时间|NotNull" />
						<span style="color: red">*</span>
					</td> -->
				<tr>
                    <th>法院受理情况：</th>
                    <td colspan="3">
                        <select name="slqk" >
                            <option value="">请选择</option>
                            #foreach($slqk in $slqkList)
                            <option value="$slqk.value">$slqk.name</option>
                            #end
                        </select>
                        <script type="text/javascript">selected(document.form1.slqk,"$!xzqz.slqk")</script>
                    </td>
                </tr>
                <tr>
                
                <th>案件名称：</th>
					<td  colspan="3">
						<textarea id="aj_name" name="aj_name" readonly="readonly" cols="95" rows="3" verify="案件名称|NotNull">$!xzqz.aj_name</textarea> 
						<span style="color: red">*</span>
					</td>
               </tr>

				<tr>
					<th>行政强制理由：</th>
					<td colspan="3">
						<textarea id="reason" name="reason" cols="95" rows="3" verify="强制理由|NotNull">$!xzqz.reason</textarea>
						<span style="color: red">*</span>
					</td>
				</tr>

				<tr>
					<th>行政强制依据：</th>
					<td colspan="3">
						<textarea id="reply" name="reply" cols="95" rows="3" verify="行政强制依据|NotNull">$!xzqz.reply</textarea> 
						<span style="color: red">*</span>
					</td>
				</tr>
				<tr>
				 <th>执行情况：</th>
                    <td colspan="3">
                        <select name="qzzxqk">
                            <option value="">请选择</option>
                            #foreach($zxqk in $zxqkList)
                            <option value="$zxqk.value">$zxqk.name</option>
                            #end
                        </select>
                        <script type="text/javascript">selected(document.form1.qzzxqk,"$!xzqz.qzzxqk")</script>
                    </td>
				</tr>

			<!-- 	<tr>
					<th>行政强制结论：</th>
					<td colspan="3">
						<textarea id="conslusion" name="conslusion" cols="95" rows="3" verify="行政强制结论|NotNull">$!xzqz.conslusion</textarea>
						<span style="color: red">*</span>
					</td>
				</tr>

				<tr>
					<th>执行情况：</th>
					<td colspan="3">
						<textarea id="zxqk" name="zxqk" cols="95" rows="3" verify="执行情况|NotNull">$!xzqz.zxqk</textarea> 
						<span style="color: red">*</span>
				    </td>
				</tr>

				
                       <tr>
                           <td align="right" width="100" >处罚履行时间：</td>
                           <td width="100">
                               <input class="Wdate" onclick="WdatePicker();" name="cflx_date" id="cflx_date" size="20" maxlength="50" verify="处罚履行时间|NotNull"></input><span style="color:red">*</span>
                           </td>
                       </tr>
                       -->

				<tr>
					<th>上传附件：</td>
					<td  colspan="3">
						<span class="attachement" style="padding: 2px; display: inline-block;" name="editable-input"> 
						<input type="text" name="fj">
						<button class="btn-text btn-attachement" onclick="loadFileClickOut(this);" type="button" fileinputname="fj" id="fj_button">选择</button>
						</span> 
						<span style="color: gray; font-size: 10px;"></span>
					</td>
				</tr>
				<tr id="file_tr" style="display: none;">
					<th>文件列表：</th>
					<td  colspan="3">
						<span id="file_list"></span>
					</td>
				</tr>

				<tr>
					<th>已上传：</th>
					<td colspan="3">
						#if($xzqz.file_html) 
							<span id="span_file" name="span_file">$!xzqz.file_html</span> 
						#else 
							无 
						#end
					</td>
				</tr>
				<tr>
					<th>修改原因：</th>
					<td  colspan="3">
						<textarea id="u_reason" name="u_reason" cols="95" rows="3" verify="修改原因|NotNull"></textarea>
						<span style="color: red">*</span>
					</td>
				</tr>

				<tr>
					<th>修改依据：</th>
					<td colspan="3">
						<textarea id="basis" name="basis" cols="95" rows="3" verify="修改依据|NotNull"></textarea> 
						<span style="color: red">*</span>
					</td>
				</tr>
				<!-- <tr> 
      				<td dateclass="forth" align="right">证明材料：</td> 
      				<td colspan="3">
				      <input type="hidden" id="fj1" name="fj1">
				      <input id="filename1" name="filename1" type="text" value="" >
				      <input id="filepath1" name="filepath1" type="hidden">
				      <input name="filesize1" type="hidden">
				      <button class="btn-text btn-attachement" onclick="loadFile1();" type="button" fileinputname="fj1" id="fj_button">选择</button></td> 
     			</tr>  -->

			</table>
		</div>
    </div>
    <div class="pageBtnarea">
		  <input class="button" type="button" name="btnOk" value="确认"  onclick="doSave()" />
          <input class="button" type="button" name="btnOk" value="关闭"  onclick="window.close();" />
	</div>
</form>
</body>
</html>