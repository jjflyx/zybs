<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html style="overflow-y:auto">
<head>
	<title>$!app_name</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<!-- 框架 -->
	<link href="${base}/include/css/default.css" rel="stylesheet" type="text/css"/>
	<script type='text/javascript'>
		var CONTEXTPATH = '${base}';
		var stylePath = '$!stylename';

	</script>
	<script src="${base}/include/js/main.js"></script>
	<script src="${base}/include/js/string.js"></script>
	<!-- 分页  注意顺序 -->
	<link href="${base}/include/css/themes/gray/easyui.css" rel="stylesheet" type="text/css"/>
	<script src="${base}/include/js/jquery.easyui.min.js"></script>
	<!-- 树 -->
	<script type="text/javascript" src="${base}/include/controls/ztree/jquery.ztree.core-3.5.min.js"></script>
	<link rel="stylesheet" href="${base}/include/controls/ztree/zTreeStyle/zTreeStyle.css" type="text/css">

	<script>
		/*
		 function initCheckbox(){
		 $("input[name='id']").each(function(){
		 var tag=true;
		 $(this).bind("click",function(){
		 var id=$(this).val();
		 var len=id.length;
		 if(tag){
		 tag=false;

		 $("input[name='id']").each(function(){
		 if($(this).val().substring(0,len)==id){
		 $(this).attr("checked",true);
		 }
		 });
		 }else{
		 tag=true;

		 $("input[name='id']").each(function(){
		 if($(this).val().substring(0,len)==id){
		 $(this).attr("checked",false);
		 }
		 });
		 }

		 });

		 });
		 }
		 */
		function getWidth(percent){
			return document.body.clientWidth*percent;
		}

		
				 
				
		function loadData(){
			$("#dg1").datagrid({
				width:"auto",
				height:"auto",
				nowrap: false,
				striped: true,
				border: true,
				collapsible:false,//是否可折叠的
				url : "${base}/private/zjgl/xyda/xydalist",//首次查询路径
				queryParams:{"id":""},//首次查询参数
				idField:"id",
				treeField:"name",
				singleSelect:false,//是否单选
				rownumbers:true,//行号
				fit: true,//自动大小
				fitColumns: true,//行自适应
				pagination:true,//分页控件
				loadMsg:'数据加载中...',
				columns : [ [
					{
						field : "a",
						title : "信用主体",
						align : 'center',
						width : 300
					},
					{
						field : "d",
						title : "类型",
						align : 'center',
						width : getWidth(0.05)
					},
					{
						field : "b",
						title : "统一社会信用代码",
						align : 'center',
						width : getWidth(0.25)
					} ,
					{
						field : "h",
						title : "发布情况",
						align : 'center',
						width : getWidth(0.10)
					},
					/*{
						field:"e",
						title:"操作",
						width:getWidth(0.10),
						align : 'center',
						formatter: function(value,row,index){
							var s1="<a href='javascript:;'>外网公布</a>";
							var s2="<a href='javascript:detailInfosx()'>浏览</a>";
							//var s3="<a href='javascript:checkSomeThing(\"重点关注\")'>重点关注</a>";
							return s1+" | "+s2;
						}
					}*/
					{
						field : "e",
						title : "浏览",
						width : getWidth(0.08),
						align : "center",
						formatter:function(val,rec){
 						val = '<img src=${base}/images/icons/icon003a15.gif />';
 						return "<a href=\"javascript:;\" onClick=\"detailInfosx();\">"+val+"</a>";	
						}
					}
				] ],
				/*frozenColumns:[[
					{field:"id",checkbox:true}
				]],*/
				onDblClickRow:function(row)
				{
					toupdate(row.id);
				},
				
				//,
				// onLoadSuccess:function(){
				//	 initCheckbox();
				// }

			});
			//设置分页控件  
		    var p = $("#dg1").datagrid("getPager");  
		    $(p).pagination({  
		        beforePageText: "第",//页数文本框前显示的汉字  
		        afterPageText: "页    共 {pages} 页",  
		        displayMsg: "当前显示 {from} - {to} 条记录   共 {total} 条记录",  
		        onBeforeRefresh:function(){ 
		        } ,
		        
		    }); 
		    
		}
		function detailInfosx(){
			var iHeight = 560;
			var iWidth = 800;
			var iTop = (window.screen.height-30-iHeight)/2; //获得窗口的垂直位置;
			var iLeft = (window.screen.width-10-iWidth)/2; //获得窗口的水平位置;
			window.open ("${base}/private/zjgl/xyda/checkSx", "失惩信息查看", 'height='+iHeight+',,innerHeight='+iHeight+',width='+iWidth+',innerWidth='+iWidth+',top='+iTop+',left='+iLeft+',toolbar=no,menubar=no,scrollbars=auto,resizeable=no,location=no,status=no');
			}
		function detailInfojl(){
			var iHeight = 560;
			var iWidth = 800;
			var iTop = (window.screen.height-30-iHeight)/2; //获得窗口的垂直位置;
			var iLeft = (window.screen.width-10-iWidth)/2; //获得窗口的水平位置;
			window.open ("${base}/private/zjgl/xyda/checkJl", "失惩信息查看", 'height='+iHeight+',,innerHeight='+iHeight+',width='+iWidth+',innerWidth='+iWidth+',top='+iTop+',left='+iLeft+',toolbar=no,menubar=no,scrollbars=auto,resizeable=no,location=no,status=no');
			}
		function sel(obj){
			var id=obj.value;
			var qx=document.getElementsByName("id");
			for(var i = 0; i < qx.length; i ++)
			{
				if(qx[i].type == "checkbox")
				{
					var v=qx[i].value;
					if(v!=""&&v.length>id.length&&v.startWith(id)){
						if(obj.checked){
							qx[i].checked=true;
						} else{
							qx[i].checked=false;
						}
					}
					if(v!=""&&v.length<id.length&&id.startWith(v)){
						if(obj.checked){
						} else{
							qx[i].checked=false;
						}
					}

				}
			}

		}
		function change(){
			var subtype = Page.getValue("subtype");
			if(subtype==1){
			var option = 
						 "<option value='0'>探矿权市场信用</option>"+
						 "<option value='1'>采矿权市场信用</option>";
				$("#subtype1").html(option);
				}
			else if(subtype==3){
				var option = "";
				option = 
						 "<option>土地价格评估服务</option>"+
						 "<option>土地规划服务信用</option>"+
						 "<option>土地登记代理服务信用</option>"+
						 "<option>矿产权价格评估服务信用</option>"+
						 "<option>地质灾害危险性评估服务信用</option>"+
						 "<option>国土资源监测服务信用</option>";
				$("#subtype1").html(option);
				}
			else if(subtype==4){
				var option = "";
				option = 
						 "<option>农村土地整治项目设计、施工、监理信用</option>"+
						 "<option>地质灾害治理工程勘查、设计、施工、监理信用</option>"+
						 "<option>矿山地质环境治理项目勘查、设计、施工、监理信用</option>"+
						 "<option>实施地质勘查信用</option>";
				$("#subtype1").html(option);
				}else{
					var option = "";
					option = 
							 "<option>无</option>";
					$("#subtype1").html(option);
					}
			}
		Page.onLoad(function() {
			loadData();

		});
		$(window).resize(function () {
			clearTimeout(timer);
			timer=setTimeout(function(){
				$('#dg1').datagrid('resize');
				$('div.panel-body').css('width','auto'); //////
			},100);
		});
	</script>
</head>
<body leftmargin="0" topmargin="0"
	  style="overflow-x: hidden; overflow-y: auto">
<table width="100%" border="0" cellspacing="6" cellpadding="0"
	   style="border-collapse: separate; border-spacing: 6px;">
	<tr valign="top">
		<td>
			<form name='form1' id="from1" method='post'>
				<input type="hidden" name="doAction" value=""> <input
					type="hidden" name="sys_menuid" value="$!sys_menuid"> <input
					type="hidden" name="checkids" value=""> <input
					type="hidden" name="deltype" value="1">
				<table width="100%" border="0" cellspacing="0" cellpadding="0"
					   class="blockTable">
					<tr>
						<td class="blockTd">
							<table width="100%" border="0" cellspacing="0" cellpadding="6">
								<!-- <tr>
									<td valign="middle"><img
											src="${base}/images/icons/icon042a4.gif"
											width="20" height="20" />&nbsp;信用档案</td>
								</tr> -->
								<tr>
									<td>
										&nbsp;
										业务类别：<select id="subtype" name="subtype" onchange="change();">
													<option>请选择</option>
													<option value="0">土地市场信用</option>
													<option value="1">矿业权市场信用</option>
													<option value="9">  -|探矿权市场信用</option>
													<option value="9">  -|采矿权市场信用</option>
													<option value="2">测绘地理市场信用</option>
													<option value="3">国土资源中介服务市场信用</option>
													<option value="9">  -|土地价格评估服务</option>
													<option value="9">  -|土地规划服务信用</option>
													<option value="9">  -|土地登记代理服务信用</option>
													<option value="9">  -|矿产权价格评估服务信用</option>
													<option value="9">  -|地质灾害危险性评估服务信用</option>
													<option value="9">  -|国土资源监测服务信用</option>
													<option value="4">国土资源工程项目市场信用</option>
													<option value="9">  -|农村土地整治项目</option>
													<option value="9">  -|地质灾害治理工程</option>
													<option value="9">  -|矿山地质环境治理项目信用</option>
													<option value="9">  -|实施地质勘查信用</option>
													<option value="5">行政处罚信息</option>
													<option value="6">参与招标、拍卖、挂牌信用</option>
												</select>
									    &nbsp;
										信用主体类型：<select>
														<option>请选择</option>
														<option>法人</option>
														<option>自然人</option>
														<option>其他组织</option>
													</select>
										&nbsp;
										关键字：<input type="text" name="text" id="text" size="20" placeholder="信用主体名称"></input>
										&nbsp;
										<input type="button" name="check" id="check" value="查询"></input>
									</td>
								</tr>
								
								<tr>
									<td style="padding: 0px 5px;" height="360" >
										<div id="dg1" style="width:100%;height:100%;"></div>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</form>
		</td>
	</tr>
</table>
</body>
</html>
