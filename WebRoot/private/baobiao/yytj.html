<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>$!app_name</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<!-- 框架 -->
	<script type='text/javascript'>
		var CONTEXTPATH = '${base}';
		var stylePath = '$!stylename';
	</script>
	<link rel="stylesheet" type="text/css" href="${base}/include/css/blue/style.css" />
	<script src="${base}/include/js/main.js"></script>
	<script src="${base}/include/js/string.js"></script>
	<!-- 日期控件  -->
	<script type="text/javascript" 	src="${base}/include/controls/my97/WdatePicker.js"></script>
	<script type="text/javascript" 	src="${base}/include/js/map.js"></script>
	<link rel="stylesheet" href="${base}/include/controls/my97/skin/WdatePicker.css" 	type="text/css">
	<!-- content area -->
	<link rel="stylesheet" href="${base}/include/fusionCharts/assets/prettyPhoto/css/prettyPhoto.css" type="text/css" media="screen" charset="utf-8" />
	<script language="JavaScript" src="${base}/include/fusionCharts/FusionCharts.js"></script>
	<script src="${base}/include/fusionCharts/assets/ui/js/lib.js" type="text/javascript"></script>
	<script type="text/javascript" src="${base}/include/fusionCharts/Charts/FusionCharts.js"></script>
	<script type="text/javascript" src="${base}/include/fusionCharts/Charts/FusionCharts.jqueryplugin.js"></script>
	<style type="text/css">
		<!--
		html,body{ overflow-y:hidden;}
		table.blz_data{ border-collapse:collapse; }
		.blz_data td{ border:#D3D3D3 solid 1px; padding:2px; line-height: 20px;}
		.tableList td{ padding:2px 0;}
		/*中间内容——右边内容*/
		-->
	</style>
	<script>
		/*$(function(){
		 $("#bgjs td").css("font-size","13px").css("height","28px").css("border","1px solid #d3d3d3");
		 });*/
		function getWidth(percent) {
			return document.body.clientWidth * percent;
		}

		function loadData(){
			if($("#startdate").val()>$("#enddate").val()){
				var tmp=$("#startdate").val();
				$("#startdate").val($("#enddate").val());
				$("#enddate").val(tmp);
			}
			$("#printnote").html("正在查询，请稍后！");
			form1.submit();
		}

		function getList(unitid,state,startdate,enddate){
			window.open("${base}/private/baobiao/infolist?unitid="+unitid+"&state="+state+"&startdate="+startdate+"&enddate="+enddate);
		}

		function toprintln() {
			printform.htmlbody.value = printnote.innerHTML;
			printform.filename.value = titlename.innerHTML;
			printform.submit();
		}

		/* //第一个参数：显示数据，第二个参数：显示的图形类型，第三个参数，图形id，唯一的，
		jQuery.fn.getChat = function(data,type,chartId,width,hight){
			var areaObject = eval(data);
			var length=areaObject.length;
			var strXML = "<chart showLegend='1'  caption='异议处理统计情况' labelDisplay='ROTATE' slantLabels='1'  palette='2' animation='1' formatNumberScale='0' numberScaleUnit='件' xAxisName=''  baseFont='宋体' baseFontSize='12'>";
			strXML = strXML+"<categories>";
			for(var x in areaObject){
				if(typeof(areaObject[x][0])!='undefined'){
					strXML = strXML + "<category label='"+areaObject[x][0]+"' />";
				}
			}
			strXML = strXML+"</categories>";

			for(var x in areaObject){
				if(typeof(areaObject[x][0])!='undefined'){
					if(x==0){
						strXML = strXML + " <set label='"+areaObject[x][0]+"' value='"+areaObject[x][1]+"' isSliced='1' />   ";
					}else{
						strXML = strXML + " <set label='"+areaObject[x][0]+"' value='"+areaObject[x][1]+"' isSliced='0' />   ";
					}
				}
			}
			strXML = strXML+"</chart>";
			var chart1 = new FusionCharts(CONTEXTPATH+"/include/fusionCharts/"+type+".swf", chartId, width, hight);
			chart1.setDataXML(strXML);
			chart1.render(this.get(0));

		}; */
		/* //发改委图形统计
		function getChart(type){
			$("#biaotou").hide();
			//var type="Pie3D";//Column3D
			var a = "";
			jQuery.ajax({
				"type":"get",
				"async":false,
				"url": "${base}/private/baobiao/getChart?sys_random=" + Math.random(),
				"data":a,
				"contentType": "application/x-www-form-urlencoded",
				"success":function(data){
					if(data){
						$('#chartdiv').getChat(data,type,'chart1_id','100%',"400");
					}
				}
			});
		} */
		
		function showTab(startdate,enddate,xzqh,xy_type,state,cz){
			var name=""
			var url="${base}/private/baobiao/yytjYm?startdate="+startdate+"&enddate="+enddate+"&xzqh="+xzqh+"&xy_type="+xy_type+"&state="+state+"&cz="+cz;
			parent.addTab(name,url);
		}

	</script>
</head>
<body leftmargin="0" topmargin="0">
<form name='form1' id="form1" method='post' action="${base}/private/baobiao/yytj">
	<div id="searchArea" region="north" border="false" style="overflow: hidden; padding: 10px 10px 0px 10px">
		<table width="96%" border="0" cellspacing="0" cellpadding="6" >
			<tr>
				<td nowrap>
					&nbsp;&nbsp;异议申请时间
					<input id="startdate" name="startdate" type="text" size="12" readonly class="Wdate" onClick="WdatePicker()" value="$!startdate" />
					至
					<input id="enddate" name="enddate" type="text" size="12" class="Wdate" onClick="WdatePicker()" value="$!enddate"  readonly="readonly" />
					#if($!sxld!=1)
					&nbsp;&nbsp;行政区划：
					<input type="hidden"  name="xzqhValue" id="xzqhValue" value="$!xzqhObj.value"/>
					<input type="hidden"  id="xzqhName" value="$!xzqhObj.name" />
					#parse("private/global/xzqh.html")
					#end
					&nbsp;&nbsp;目录
					<select name="xylx" id="xylx">
						<option value="">请选择</option>
						#foreach($obj in $csvalueList)
						<option value="$!obj.value">
							<script type="text/javascript">
								document.write(gettreecode('$!obj.value'));
							</script>$!obj.name
						</option>
						#end
					</select>
					<script type="text/javascript">selected(form1.xylx, '$!xylx');</script>
					&nbsp;&nbsp;
					<input class="button" type="button" id="dosearch" name="dosearch" value="查   询" onclick="loadData();" />
					&nbsp;&nbsp;
					<input class="button" type="button" id="dosearch" name="dosearch" value="导出Excel" onclick="toprintln();" />
					&nbsp;&nbsp;
					
				</td>
			</tr>
			<tr id="bz1" style="display:block">
				<td>
				</td>
			</tr>
		</table>
	</div>
	<div region="center" border="false" id="printnote" style="height: 100%; padding: 0px 0px 10px 10px;" >
		<div id="biaotou">
			<!--导出时表头需要背景色时，请给表头的tr加上  bgcolor="#ebebeb" -->
			<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="tableList" id="table_head">
				<caption><h3 id="titlename">异议统计报表（$!startdate 至 $!enddate）</h3></caption>
				<thead>
				<tr align="center">
					<td width="32" rowspan="2">序号</td>
					<td width="70" rowspan="2">行政区划</td>
					#foreach($head as $baobiaoHeadList)
					<td colspan="5">$!head.name</td>
					#end
				</tr>
				<tr align="center">
					#foreach($head as $baobiaoHeadList)
					<td width="40">未处<br>理</td>
					<td width="40">处理<br>中</td>
					<td width="40">维持<br/>惩戒</td>
					<td width="40">修改<br/>惩戒</td>
					<td width="40">撤销<br/>惩戒</td>
					#end
				</tr>
				</thead>
			</table>
		</div>
		<div id="scroll_table" style="overflow:auto;">
			<div class="IE6height1">
				<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="tableList" style="border-top:0;" id='table_body'>
					<tbody>
					#if($!xzqhObj.value=="340000")
					<tr align="center" bgcolor="#FFFFFF">
						<td width="32">1</td>
						<td width="70">行业协会</td>
						#foreach($head as $baobiaoHeadList)
						<td width="40">
							#if($!allListMap.get("$!head.value").get("h_wclMap").get("wcl"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','$!head.value','0');">$!allListMap.get("$!head.value").get("h_wclMap").get("wcl")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("h_clzMap").get("clz"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','$!head.value','1');">$!allListMap.get("$!head.value").get("h_clzMap").get("clz")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("h_wcMap").get("wc"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','$!head.value','2','1');">$!allListMap.get("$!head.value").get("h_wcMap").get("wc")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("h_xgMap").get("xg"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','$!head.value','2','2');">$!allListMap.get("$!head.value").get("h_xgMap").get("xg")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("h_cxMap").get("cx"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','$!head.value','2','3');">$!allListMap.get("$!head.value").get("h_cxMap").get("cx")</a>
							#else
							0
							#end
						</td>
						#end
					</tr>
					#end
					#foreach($xzqh as $xzqhList)
					<tr align="center" bgcolor="#FFFFFF" #if($velocityCount==1)id="trForName"#end>
						<td width="32">
							#if($!xzqhObj.value=="340000")
							#set($vsize=$velocityCount + 1)
							$!{vsize}
							#else
							$!{velocityCount}
							#end
						</td>
						<td width="70">
							#if($!xzqh.name == "安徽省")
							省厅
							#else
							$!xzqh.name
							#end
						</td>
						#foreach($head as $baobiaoHeadList)
						<td width="40">
							#if($!allListMap.get("$!head.value").get("wclMap").get("$!xzqh.value"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','$!head.value','0');">$!allListMap.get("$!head.value").get("wclMap").get("$!xzqh.value")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("clzMap").get("$!xzqh.value"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','$!head.value','1');">$!allListMap.get("$!head.value").get("clzMap").get("$!xzqh.value")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("wcMap").get("$!xzqh.value"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','$!head.value','2','1');">$!allListMap.get("$!head.value").get("wcMap").get("$!xzqh.value")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("xgMap").get("$!xzqh.value"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','$!head.value','2','2');">$!allListMap.get("$!head.value").get("xgMap").get("$!xzqh.value")</a>
							#else
							0
							#end
						</td>
						<td width="40">
							#if($!allListMap.get("$!head.value").get("cxMap").get("$!xzqh.value"))
							<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','$!head.value','2','3');">$!allListMap.get("$!head.value").get("cxMap").get("$!xzqh.value")</a>
							#else
							0
							#end
						</td>
						#end
					</tr>
					#end
					</tbody>
				</table>
			</div>
		</div>
		<div id="chartdiv"  style="height: 500px;"></div>
		</div>
</form>

<form action="${base}/DownFile" name="printform" method="post">
	<textarea rows="" cols="" style="display: none;" name="htmlbody"></textarea>
	<input name="docname" type="hidden" value="统计报表"/>
	<input name="filename" type="hidden" />
</form>

<script>
$(function(){
	function customHeightSet(){
			$("#table_head").width($(".IE6height1>.tableList").outerWidth())
		var otherH	=	$("#searchArea").outerHeight()	+	$("#table_head").outerHeight()-30;
		$("#scroll_table").height(document.documentElement.clientHeight-otherH);
		if($(".IE6height1>.tableList").height()>$("#scroll_table").height()){
			$("#scroll_table").width(document.documentElement.clientWidth-10);
			if($(".IE6height1>.tableList").width()>document.documentElement.clientWidth){
				$("#biaotou").width($("#scroll_table").outerWidth()-10);
			}else{
				$("#biaotou").width($("#scroll_table").outerWidth()-10);
				$("#table_head").width(document.documentElement.clientWidth-10)
				$("#table_body").width(document.documentElement.clientWidth-10);
			}
		}else{
			if($(".IE6height1>.tableList").outerWidth()>document.documentElement.clientWidth){
				$("#scroll_table").width(document.documentElement.clientWidth-10);
				$("#biaotou").width($("#scroll_table").outerWidth());
			}else{
				$("#scroll_table").width(document.documentElement.clientWidth-10);
					$("#biaotou").width(document.documentElement.clientWidth-10);
					$("#table_head").width(document.documentElement.clientWidth-10)
					$("#table_body").width(document.documentElement.clientWidth-10);
			}
		}
		if($("#table_head").outerWidth()>$("#biaotou").outerWidth()){
			$("#biaotou").css("overflow","hidden")
		}else{
			$("#biaotou").css("overflow","")
		}
		fix();
	}
	window.onresize = function(){
		customHeightSet();
	}
	window.onload = function(){
		customHeightSet();
	}
});
function fix(){
	for(var i=0;i<=$('#trForName').find('td:last').index();i++){
		$('#trForthead col').eq(i).attr('width',$('#trForName').find('td').eq(i).width()+1);
	}
}
window.load=fix();
$(window).resize(function(){
	return fix();
});

//当有横向滚动条时，需要此js，使内容滚动头部也能滚动。
$('#scroll_table').scroll(function(){
	$('#table_head').css('margin-left',-($('#scroll_table').scrollLeft()));
});
</script>
</body>
</html>