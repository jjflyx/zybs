<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>$!app_name</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<!-- 框架 -->
	<script type='text/javascript'>
		var CONTEXTPATH = '${base}';
		var stylePath = '$!stylename';
	</script>
	<link rel="stylesheet" type="text/css" href="${base}/include/css/blue/style.css" />
	<script src="${base}/include/js/main.js"></script>
	<script src="${base}/include/js/string.js"></script>
	<link rel="stylesheet" type="text/css" href="${base}/include/css/blue/style.css" />
	<script src="${base}/include/js/main.js"></script>
	<script src="${base}/include/js/string.js"></script>
	<!-- 日期控件  -->
	<script type="text/javascript" 	src="${base}/include/controls/my97/WdatePicker.js"></script>
	<script type="text/javascript" 	src="${base}/include/js/map.js"></script>
	<link rel="stylesheet" href="${base}/include/controls/my97/skin/WdatePicker.css" 	type="text/css">
	<!-- content area -->
	<link rel="stylesheet" href="${base}/include/fusionCharts/assets/prettyPhoto/css/prettyPhoto.css" type="text/css" media="screen" charset="utf-8" />
	<script language="JavaScript" src="${base}/include/fusionCharts/FusionCharts.js"></script>
	<script src="${base}/include/fusionCharts/assets/ui/js/lib.js" type="text/javascript"></script>
	<script type="text/javascript" src="${base}/include/fusionCharts/Charts/FusionCharts.js"></script>
	<script type="text/javascript" src="${base}/include/fusionCharts/Charts/FusionCharts.jqueryplugin.js"></script>
	<style type="text/css">
		#chartContainer {
			width : 100%;
			height: 400px;
		}
	</style>
	<!-- content area -->
	<style type="text/css">
		<!--
		html,body{ overflow-y:hidden;}
		table.blz_data{ border-collapse:collapse; }
		.blz_data td{ border:#D3D3D3 solid 1px; padding:2px; line-height: 20px;}
		.tableList td{ padding:2px 0;}
		/*中间内容——右边内容*/
		-->
	</style>
	<script>
		#if($msg)
			alert('$!msg');
		#end
		/*$(function(){
		 $("#bgjs td").css("font-size","13px").css("height","28px").css("border","1px solid #d3d3d3");
		 });*/
		function getWidth(percent) {
			return document.body.clientWidth * percent;
		}

		function getExcel(){
			$("#showExcel").hide();
			$("#showChars").show();
			$("#printnote").show();
			$("#chars_area").hide();
		}

		function loadData(){
			if($("#startdate").val()>$("#enddate").val()){
				var tmp=$("#startdate").val();
				$("#startdate").val($("#enddate").val());
				$("#enddate").val(tmp);
			}
			$("#printnote").html("正在查询，请稍后！");
			form1.submit();
		}

		function getList(unitid,state,startdate,enddate){
			window.open("${base}/private/baobiao/infolist?unitid="+unitid+"&state="+state+"&startdate="+startdate+"&enddate="+enddate);
		}

		function toprintln() {
			printform.htmlbody.value = printnote.innerHTML;
			printform.filename.value = titlename.innerHTML;
			printform.submit();
		}
		
		function showTab(startdate,enddate,xzqh,xy_type){
			var name=""
			var url="${base}/private/baobiao/sxjlYm?startdate="+startdate+"&enddate="+enddate+"&xzqh="+xzqh+"&xy_type="+xy_type;
			parent.addTab(name,url);
		}
		
	</script>
</head>
<body leftmargin="0" topmargin="0">
<form name='form1' id="form1" method='post' action="${base}/private/baobiao/sxjl">
	<div id="searchArea" region="north" border="false" style="overflow: hidden; padding: 10px 10px 0px 10px">
		<table width="96%" border="0" cellspacing="0" cellpadding="6" >
			<tr>
				<td nowrap>
					&nbsp;&nbsp;时间：
					<input id="startdate" name="startdate" type="text" size="12" readonly class="Wdate" onClick="WdatePicker()" value="$!startdate" />
					至
					<input id="enddate" name="enddate" type="text" size="12" class="Wdate" onClick="WdatePicker()" value="$!enddate"  readonly="readonly" />
					#if($!sxld!=1)
					&nbsp;&nbsp;行政区划：
					<input type="hidden"  name="xzqhValue" id="xzqhValue" value="$!xzqhObj.value"/>
					<input type="hidden"  id="xzqhName" value="$!xzqhObj.name" />
					#parse("private/global/xzqh.html")
					#end
					
					&nbsp;&nbsp;
					<input class="button" type="button" id="dosearch" name="dosearch" value="查   询" onclick="loadData();" />
					&nbsp;&nbsp;
					<input class="button" type="button" id="dosearch" name="dosearch" value="导出Excel" onclick="toprintln();" />
					&nbsp;&nbsp;
					<input type="button" class="button" id="showChars" onclick="showPrettyPhoto();" value="柱状图" />
					<input type="button" class="button" id="showExcel" onclick="getExcel();" value="Excel报表" style="display: none;" />
				</td>
			</tr>
			<tr id="bz1" style="display:block">
				<td>
				</td>
			</tr>
		</table>
	</div>
	<!-- content area -->
	<div class="content-area" id="chars_area" style="display:none;">
		<div id="content-area-inner-main">
			<!--<p class="text" align="center">Open the chart in pretty photo using jQuery</p>-->
			<div id="messageBox" style="margin-left:100px; margin-right:100px; display:none;"></div>
			<p>&nbsp;</p>
			<div class="clear"></div>
			<div class="gen-chart-render">
				<div id="prettyphoto-container">
					<div id="chartContainer"></div>
				</div>
				<script type="text/javascript">
					var xzqhGson=$!xzqhGson;
					var xyGson=$!xyGson;
					var charsData=$!charsData;
					var unitGson=#if($!unitGson) $!unitGson #else "" #end;

					/* $(document).ready(function() {
						$('#chartContainer').prettyPhoto({opacity: 0.35, showTitle: true, allowresize: false });
					}); */

					function showPrettyPhoto()
					{
						$("#printnote").hide();
						$("#chars_area").show();
						$("#showExcel").show();
						$("#showChars").hide();
					}
					var dataString = "<chart caption='守信奖励统计报表' showValues='0' xAxisName='信用类型' yAxisName='件数' numberPrefix=''>";
					dataString += "<categories>";
					//迭代横轴
					$.each(xyGson, function(i, item){
						dataString += "<category label='"+item.name+"' />";
					});
					$.each(unitGson, function(u, item){
						dataString += "<category label='"+item.name+"' />";
					});
					dataString += "</categories>";

					$.each(charsData, function(j, jitem){
						dataString += "<dataset seriesName='"+jitem.name+"'>"+
								"<set  value='" + jitem.tdscxy + "' />" +
								"<set  value='" + jitem.ckqscxy + "' />" +
								"<set  value='" + jitem.tkqscxy + "' />" +
								"<set  value='" + jitem.chdlscxy + "' />" +
								"<set  value='" + jitem.tdjgpgfw + "' />" +
								"<set  value='" + jitem.tdghfwxy + "' />" +
								"<set  value='" + jitem.tddjdlfwxy + "' />" +
								"<set  value='" + jitem.kcqjgpgfwxy + "' />" +
								"<set  value='" + jitem.dzzhwxxpgfwxy + "' />" +
								"<set  value='" + jitem.gtzyjcfwxy + "' />" +
								"<set  value='" + jitem.nctdzzxmsjsgjlxy + "' />" +
								"<set  value='" + jitem.dzzhzlgckcsjsgjlxy + "' />" +
								"<set  value='" + jitem.ksdzhjzlxmkcsjsgjlxy + "' />" +
								"<set  value='" + jitem.ssdzkcxy + "' /></dataset>";
					});
					dataString += "</chart>";
					$("#chartContainer").insertFusionCharts({swfUrl: "${base}/include/fusionCharts/Charts/MSColumn3D.swf", dataSource: dataString, dataFormat: "xml", width: "100%", height: "100%", id: "myChartID"});
				</script>
				<!--<input type="button" onclick="showPrettyPhoto();" value="open chart in pretty photo" />-->
			</div>
			<div class="underline-dull"></div>    </div>
	</div>
	<!-- content area -->
	<div region="center" border="false" id="printnote" style="height: 100%; padding: 0px 0px 10px 10px;" >
		<div id="biaotou">
			<!--导出时表头需要背景色时，请给表头的tr加上  bgcolor="#ebebeb" -->
			<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="tableList" id="table_head">
            
				<caption><h3 id="titlename">守信奖励统计报表（$!startdate 至 $!enddate）</h3></caption>
				<thead>
				<tr align="center">
					<td width="40" rowspan="2">序号</td>
					<td rowspan="2">行政区划</td>
					<td width="70" rowspan="2">土地市场<br>信用</td>
					<td colspan="2">矿业权市场信用</td>
					<td width="70" rowspan="2">测绘地理<br>市场</td>
					<td colspan="6">国土资源中介服务市场</td>
					<td colspan="4">国土资源工程项目市场</td>
				</tr>
				<tr align="center">

					<td width="50">采矿<br/>信用</td>
					<td width="50">探矿<br/>信用</td>

					<td width="50">土地<br/>评估</td>
					<td width="50">土地<br/>规划</td>
					<td width="50">土地<br/>登记</td>
					<td width="50">矿产<br/>评估</td>
					<td width="50">地质<br/>评估</td>
					<td width="50">监测<br/>服务</td>

					<td width="50">土地<br/>整治</td>
					<td width="50">地质<br/>治理</td>
					<td width="50">矿山<br/>治理</td>
					<td width="50">地质<br/>勘察</td>
				</tr>
				</thead>
			</table>
		</div>
		<div id="scroll_table" style="overflow:auto;">
			<div class="IE6height1">
				<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="tableList" style="border-top:0;" id='table_body'>
                    <tbody>
                    #if($hyxhMap)
                    #set($sum=0)
                    <tr align="center" bgcolor="#FFFFFF">
                    	#set($sum=$sum + 1)
                    	<td width="40">$!sum</td>
                    	<td >行业协会</td>
						<td width="70">
							#if($!hyxhMap.get("0004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','0004');">$!hyxhMap.get("0004")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00030002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00030002');">$!hyxhMap.get("00030002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00030001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00030001');">$!hyxhMap.get("00030001")</a>
							#else
								0
							#end
						</td>
						<td width="70">
							#if($!hyxhMap.get("0006"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','0006');">$!hyxhMap.get("0006")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050001');">$!hyxhMap.get("00050001")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050002');">$!hyxhMap.get("00050002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050003"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050003');">$!hyxhMap.get("00050003")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050004');">$!hyxhMap.get("00050004")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050005"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050005');">$!hyxhMap.get("00050005")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00050006"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00050006');">$!hyxhMap.get("00050006")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00070001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00070001');">$!hyxhMap.get("00070001")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00070002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00070002');">$!hyxhMap.get("00070002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00070003"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00070003');">$!hyxhMap.get("00070003")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!hyxhMap.get("00070004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','hyxh','00070004');">$!hyxhMap.get("00070004")</a>
							#else
								0
							#end
						</td>
                    </tr>
                    #end
					
					#if($hyxhMap)
					#set($sum=1)
					#else
					#set($sum=0)
					#end
					#foreach($!xzqh in $!xzqhList)
					<tr align="center" bgcolor="#FFFFFF" #if($velocityCount==1)id="trForName"#end>
						#set($sum= $sum + 1)
						<td width="40">$!sum</td>
						<td>
							#if($!xzqh.name == "安徽省")
							省厅
							#else
							$!xzqh.name
							#end
						</td>
						<td width="70">
							#if($!allMap.get("$!xzqh.value").get("0004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','0004');">$!allMap.get("$!xzqh.value").get("0004")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00030002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00030002');">$!allMap.get("$!xzqh.value").get("00030002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00030001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00030001');">$!allMap.get("$!xzqh.value").get("00030001")</a>
							#else
								0
							#end
						</td>
						<td width="70">
							#if($!allMap.get("$!xzqh.value").get("0006"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','0006');">$!allMap.get("$!xzqh.value").get("0006")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050001');">$!allMap.get("$!xzqh.value").get("00050001")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050002');">$!allMap.get("$!xzqh.value").get("00050002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050003"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050003');">$!allMap.get("$!xzqh.value").get("00050003")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050004');">$!allMap.get("$!xzqh.value").get("00050004")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050005"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050005');">$!allMap.get("$!xzqh.value").get("00050005")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00050006"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00050006');">$!allMap.get("$!xzqh.value").get("00050006")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00070001"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00070001');">$!allMap.get("$!xzqh.value").get("00070001")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00070002"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00070002');">$!allMap.get("$!xzqh.value").get("00070002")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00070003"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00070003');">$!allMap.get("$!xzqh.value").get("00070003")</a>
							#else
								0
							#end
						</td>
						<td width="50">
							#if($!allMap.get("$!xzqh.value").get("00070004"))
								<a href="javascript:;" onclick="showTab('$!startdate','$!enddate','$!xzqh.value','00070004');">$!allMap.get("$!xzqh.value").get("00070004")</a>
							#else
								0
							#end
						</td>
					</tr>
					#end
					</tbody>
				</table>
		</div>
		<div id="chartdiv"  style="height: 500px;display: none;"></div>
	</div>
</form>
<form action="${base}/DownFile" name="printform" id="printform" method="post">
	<textarea rows="" cols="" style="display: none;" name="htmlbody"></textarea>
	<input name="docname" type="hidden" value="统计报表"/>
	<input name="filename" type="hidden" />
</form>
<script>
$(function(){
	function customHeightSet(){
			$("#table_head").width($(".IE6height1>.tableList").outerWidth())
		var otherH	=	$("#searchArea").outerHeight()	+	$("#table_head").outerHeight()-30;
		$("#scroll_table").height(document.documentElement.clientHeight-otherH);
		if($(".IE6height1>.tableList").height()>$("#scroll_table").height()){
			$("#scroll_table").width(document.documentElement.clientWidth-10);
			if($(".IE6height1>.tableList").width()>document.documentElement.clientWidth){
				$("#biaotou").width($("#scroll_table").outerWidth()-10);
			}else{
				$("#biaotou").width($("#scroll_table").outerWidth()-10);
				$("#table_head").width(document.documentElement.clientWidth-10)
				$("#table_body").width(document.documentElement.clientWidth-10);
			}
		}else{
			if($(".IE6height1>.tableList").outerWidth()>document.documentElement.clientWidth){
				$("#scroll_table").width(document.documentElement.clientWidth-10);
				$("#biaotou").width($("#scroll_table").outerWidth());
			}else{
				$("#scroll_table").width(document.documentElement.clientWidth-10);
					$("#biaotou").width(document.documentElement.clientWidth-10);
					$("#table_head").width(document.documentElement.clientWidth-10)
					$("#table_body").width(document.documentElement.clientWidth-10);
			}
		}
		if($("#table_head").outerWidth()>$("#biaotou").outerWidth()){
			$("#biaotou").css("overflow","hidden")
		}else{
			$("#biaotou").css("overflow","")
		}
		fix();
	}
	window.onresize = function(){
		customHeightSet();
	}
	window.onload = function(){
		customHeightSet();
	}
});
function fix(){
	for(var i=0;i<=$('#trForName').find('td:last').index();i++){
		$('#trForthead col').eq(i).attr('width',$('#trForName').find('td').eq(i).width()+1);
	}
}
window.load=fix();
$(window).resize(function(){
	return fix();
});

//当有横向滚动条时，需要此js，使内容滚动头部也能滚动。
$('#scroll_table').scroll(function(){
	$('#table_head').css('margin-left',-($('#scroll_table').scrollLeft()));
});
</script>
</body>
</html>
