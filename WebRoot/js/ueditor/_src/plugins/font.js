UE.plugins["font"]=function(){var a=this,c={"forecolor":"color","backcolor":"background-color","fontsize":"font-size","fontfamily":"font-family","underline":"text-decoration","strikethrough":"text-decoration"};a.setOpt({"fontfamily":[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],"fontsize":[10,11,12,14,16,18,20,24,36]});for(var b in c){(function(e,d){UE.commands[e]={execCommand:function(m,j){j=j||(this.queryCommandState(m)?"none":m=="underline"?"underline":"line-through");var h=this,g=this.selection.getRange(),l;if(j=="default"){if(g.collapsed){l=h.document.createTextNode("font");g.insertNode(l).select();}h.execCommand("removeFormat","span,a",d);if(l){g.setStartBefore(l).setCursor();domUtils.remove(l);}}else{if(h.currentSelectedArr&&h.currentSelectedArr.length>0){for(var f=0,o;o=h.currentSelectedArr[f++];){g.selectNodeContents(o);g.applyInlineStyle("span",{"style":d+":"+j});}g.selectNodeContents(this.currentSelectedArr[0]).select();}else{if(!g.collapsed){if((e=="underline"||e=="strikethrough")&&h.queryCommandValue(e)){h.execCommand("removeFormat","span,a",d);}g=h.selection.getRange();g.applyInlineStyle("span",{"style":d+":"+j}).select();}else{var k=domUtils.findParentByTagName(g.startContainer,"span",true);l=h.document.createTextNode("font");if(k&&!k.children.length&&!k[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){g.insertNode(l);if(e=="underline"||e=="strikethrough"){g.selectNode(l).select();h.execCommand("removeFormat","span,a",d,null);k=domUtils.findParentByTagName(l,"span",true);g.setStartBefore(l);}k.style.cssText+=";"+d+":"+j;g.collapse(true).select();}else{g.insertNode(l);g.selectNode(l).select();k=g.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(l,"a",true)){g.setStartBefore(l).setCursor();domUtils.remove(l);return;}h.execCommand("removeFormat","span,a",d);}k.style.cssText=d+":"+j;l.parentNode.insertBefore(k,l);if(!browser.ie||browser.ie&&browser.version==9){var n=k.parentNode;while(!domUtils.isBlockElm(n)){if(n.tagName=="SPAN"){k.style.cssText=n.style.cssText+";"+k.style.cssText;}n=n.parentNode;}}if(opera){setTimeout(function(){g.setStart(k,0).setCursor();});}else{g.setStart(k,0).setCursor();}}domUtils.remove(l);}}}return true;},queryCommandValue:function(g){var f=this.selection.getStart();if(g=="underline"||g=="strikethrough"){var h=f,i;while(h&&!domUtils.isBlockElm(h)&&!domUtils.isBody(h)){if(h.nodeType==1){i=domUtils.getComputedStyle(h,d);if(i!="none"){return i;}}h=h.parentNode;}return"none";}return domUtils.getComputedStyle(f,d);},queryCommandState:function(f){if(this.highlight){return -1;}if(!(f=="underline"||f=="strikethrough")){return 0;}return this.queryCommandValue(f)==(f=="underline"?"underline":"line-through");}};})(b,c[b]);}};