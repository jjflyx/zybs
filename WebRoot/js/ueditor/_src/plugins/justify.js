(function(){var c=domUtils.isBlockElm,b={left:1,right:1,center:1,justify:1},a=function(g,d){var j=g.createBookmark(),m=function(o){return o.nodeType==1?o.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(o):!domUtils.isWhitespace(o);};g.enlarge(true);var n=g.createBookmark(),i=domUtils.getNextDomNode(n.start,false,m),k=g.cloneRange(),f;while(i&&!(domUtils.getPosition(i,n.end)&domUtils.POSITION_FOLLOWING)){if(i.nodeType==3||!c(i)){k.setStartBefore(i);while(i&&i!==n.end&&!c(i)){f=i;i=domUtils.getNextDomNode(i,false,null,function(o){return !c(o);});}k.setEndAfter(f);var h=k.getCommonAncestor();if(!domUtils.isBody(h)&&c(h)){domUtils.setStyles(h,utils.isString(d)?{"text-align":d}:d);i=h;}else{var e=g.document.createElement("p");domUtils.setStyles(e,utils.isString(d)?{"text-align":d}:d);var l=k.extractContents();e.appendChild(l);k.insertNode(e);i=e;}i=domUtils.getNextDomNode(i,false,m);}else{i=domUtils.getNextDomNode(i,true,m);}}return g.moveToBookmark(n).moveToBookmark(j);};UE.commands["justify"]={execCommand:function(f,j){var e=this.selection.getRange(),d;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var g=0,h;h=this.currentSelectedArr[g++];){if(domUtils.isEmptyNode(h)){d=this.document.createTextNode("p");e.setStart(h,0).collapse(true).insertNode(d).selectNode(d);}else{e.selectNodeContents(h);}a(e,j.toLowerCase());d&&domUtils.remove(d);}e.selectNode(this.currentSelectedArr[0]).select();}else{if(e.collapsed){d=this.document.createTextNode("p");e.insertNode(d);}a(e,j);if(d){e.setStartBefore(d).collapse(true);domUtils.remove(d);}e.select();}return true;},queryCommandValue:function(){var d=this.selection.getStart(),e=domUtils.getComputedStyle(d,"text-align");return b[e]?e:"left";},queryCommandState:function(){return this.highlight?-1:0;}};})();