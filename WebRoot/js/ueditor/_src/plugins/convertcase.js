UE.commands["touppercase"]=UE.commands["tolowercase"]={execCommand:function(f){var e=this,a=new dom.Range(e.document),d=function(){var i=e.selection.getRange();if(i.collapsed){return i;}var h=i.createBookmark(),g=h.end,k=function(l){return !domUtils.isBr(l)&&!domUtils.isWhitespace(l);},j=domUtils.getNextDomNode(h.start,false,k);while(j&&(domUtils.getPosition(j,g)&domUtils.POSITION_PRECEDING)){if(j.nodeType==3){j.nodeValue=j.nodeValue[f=="touppercase"?"toUpperCase":"toLowerCase"]();}j=domUtils.getNextDomNode(j,true,k);if(j===g){break;}}return i.moveToBookmark(h);};if(e.currentSelectedArr&&e.currentSelectedArr.length>0){for(var c=0,b;b=e.currentSelectedArr[c++];){if(b.style.display!="none"&&!domUtils.isEmptyBlock(b)){a.selectNodeContents(b).select();d();}}a.selectNodeContents(e.currentSelectedArr[0]).select();}else{d().select();}},queryCommandState:function(){return this.highlight?-1:0;}};