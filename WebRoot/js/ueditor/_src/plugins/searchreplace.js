UE.plugins["searchreplace"]=function(){var a,c,b=this;b.addListener("reset",function(){a=null;c=null;});b.commands["searchreplace"]={execCommand:function(n,d){var i=this,e=i.selection,g,h,f=0,d=utils.extend(d,{all:false,casesensitive:false,dir:1},true);if(browser.ie){while(1){var k;h=i.document.selection.createRange();k=h.duplicate();k.moveToElementText(i.document.body);if(d.all){c=0;d.dir=1;if(a){k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",a);}}else{k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",h);if(d.hasOwnProperty("replaceStr")){k.setEndPoint(d.dir==-1?"StartToEnd":"EndToStart",h);}}h=k.duplicate();if(!k.findText(d.searchStr,d.dir,d.casesensitive?4:0)){a=null;k=i.document.selection.createRange();k.scrollIntoView();return f;}k.select();if(d.hasOwnProperty("replaceStr")){g=e.getRange();g.deleteContents().insertNode(g.document.createTextNode(d.replaceStr)).select();a=e.getNative().createRange();}f++;if(!d.all){break;}}}else{var j=i.window,m=e.getNative(),k;while(1){if(d.all){if(a){a.collapse(false);h=a;}else{h=i.document.createRange();h.setStart(i.document.body,0);}m.removeAllRanges();m.addRange(h);c=0;d.dir=1;}else{h=j.getSelection().getRangeAt(0);if(d.hasOwnProperty("replaceStr")){h.collapse(d.dir==1?true:false);}}if(!c){h.collapse(d.dir<0?true:false);m.removeAllRanges();m.addRange(h);}else{m.removeAllRanges();}if(!j.find(d.searchStr,d.casesensitive,d.dir<0?true:false)){a=null;m.removeAllRanges();return f;}c=0;g=j.getSelection().getRangeAt(0);if(!g.collapsed){if(d.hasOwnProperty("replaceStr")){g.deleteContents();var l=j.document.createTextNode(d.replaceStr);g.insertNode(l);g.selectNode(l);m.addRange(g);a=g.cloneRange();}}f++;if(!d.all){break;}}}return true;}};};