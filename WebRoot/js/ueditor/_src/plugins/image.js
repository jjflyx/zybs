UE.commands["imagefloat"]={execCommand:function(a,g){var i=this,f=i.selection.getRange();if(!f.collapsed){var d=f.getClosedNode();if(d&&d.tagName=="IMG"){switch(g){case"left":case"right":case"none":var h=d.parentNode,b,c,e;while(dtd.$inline[h.tagName]||h.tagName=="A"){h=h.parentNode;}b=h;if(b.tagName=="P"&&domUtils.getStyle(b,"text-align")=="center"){if(!domUtils.isBody(b)&&domUtils.getChildCount(b,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j);})==1){c=b.previousSibling;e=b.nextSibling;if(c&&e&&c.nodeType==1&&e.nodeType==1&&c.tagName==e.tagName&&domUtils.isBlockElm(c)){c.appendChild(b.firstChild);while(e.firstChild){c.appendChild(e.firstChild);}domUtils.remove(b);domUtils.remove(e);}else{domUtils.setStyle(b,"text-align","");}}f.selectNode(d).select();}domUtils.setStyle(d,"float",g);break;case"center":if(i.queryCommandValue("imagefloat")!="center"){h=d.parentNode;domUtils.setStyle(d,"float","none");b=d;while(h&&domUtils.getChildCount(h,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j);})==1&&(dtd.$inline[h.tagName]||h.tagName=="A")){b=h;h=h.parentNode;}f.setStartBefore(b).setCursor(false);h=i.document.createElement("div");h.appendChild(b);domUtils.setStyle(b,"float","");i.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+h.innerHTML+"</p>");b=i.document.getElementById("_img_parent_tmp");b.removeAttribute("id");b=b.firstChild;f.selectNode(b).select();e=b.parentNode.nextSibling;if(e&&domUtils.isEmptyNode(e)){domUtils.remove(e);}}break;}}}},queryCommandValue:function(){var a=this.selection.getRange(),b,c;if(a.collapsed){return"none";}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){c=domUtils.getComputedStyle(b,"float");if(c=="none"){c=domUtils.getComputedStyle(b.parentNode,"text-align")=="center"?"center":c;}return{left:1,right:1,center:1}[c]?c:"none";}return"none";},queryCommandState:function(){if(this.highlight){return -1;}var a=this.selection.getRange(),b;if(a.collapsed){return -1;}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){return 0;}return -1;}};UE.commands["insertimage"]={execCommand:function(b,a){a=utils.isArray(a)?a:[a];if(!a.length){return;}var j=this,g=j.selection.getRange(),d=g.getClosedNode();if(d&&/img/i.test(d.tagName)&&d.className!="edui-faked-video"&&!d.getAttribute("word_img")){var e=a.shift();var k=e["floatStyle"];delete e["floatStyle"];domUtils.setAttributes(d,e);j.execCommand("imagefloat",k);if(a.length>0){g.setStartAfter(d).setCursor(false,true);j.execCommand("insertimage",a);}}else{var f=[],h="",l;l=a[0];if(a.length==1){h='<img src="'+l.src+'" '+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.width?'width="'+l.width+'" ':"")+(l.height?' height="'+l.height+'" ':"")+(l["floatStyle"]=="left"||l["floatStyle"]=="right"?' style="float:'+l["floatStyle"]+';"':"")+(l.title&&l.title!=""?' title="'+l.title+'"':"")+(l.border&&l.border!="0"?' border="'+l.border+'"':"")+(l.alt&&l.alt!=""?' alt="'+l.alt+'"':"")+(l.hspace&&l.hspace!="0"?' hspace = "'+l.hspace+'"':"")+(l.vspace&&l.vspace!="0"?' vspace = "'+l.vspace+'"':"")+"/>";if(l["floatStyle"]=="center"){h='<p style="text-align: center">'+h+"</p>";}f.push(h);}else{for(var c=0;l=a[c++];){h="<p "+(l["floatStyle"]=="center"?'style="text-align: center" ':"")+'><img src="'+l.src+'" '+(l.width?'width="'+l.width+'" ':"")+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.height?' height="'+l.height+'" ':"")+' style="'+(l["floatStyle"]&&l["floatStyle"]!="center"?"float:"+l["floatStyle"]+";":"")+(l.border||"")+'" '+(l.title?' title="'+l.title+'"':"")+" /></p>";f.push(h);}}j.execCommand("insertHtml",f.join(""));}},queryCommandState:function(){return this.highlight?-1:0;}};