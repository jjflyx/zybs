UE.commands["snapscreen"]={execCommand:function(){var me=this,lang=me.getLang("snapScreen_plugin");me.setOpt({snapscreenServerPort:80,snapscreenImgAlign:"center"});var editorOptions=me.options;if(!browser.ie){alert(lang.browserMsg);return;}var onSuccess=function(rs){try{rs=eval("("+rs+")");}catch(e){alert(lang.callBackErrorMsg);return;}if(rs.state!="SUCCESS"){alert(rs.state);return;}me.execCommand("insertimage",{src:editorOptions.snapscreenPath+rs.url,floatStyle:editorOptions.snapscreenImgAlign,data_ue_src:editorOptions.snapscreenPath+rs.url});};var onStartUpload=function(){};var onError=function(){alert(lang.uploadErrorMsg);};try{var nativeObj=new ActiveXObject("Snapsie.CoSnapsie");nativeObj.saveSnapshot(editorOptions.snapscreenHost,editorOptions.snapscreenServerUrl,editorOptions.snapscreenServerPort,onStartUpload,onSuccess,onError);}catch(e){me.ui._dialogs["snapscreenDialog"].open();}},queryCommandState:function(){return this.highlight||!browser.ie?-1:0;}};