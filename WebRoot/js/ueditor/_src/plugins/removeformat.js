UE.plugins["removeformat"]=function(){var a=this;a.setOpt({"removeFormatTags":"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var","removeFormatAttributes":"class,style,lang,width,height,align,hspace,valign"});a.commands["removeformat"]={execCommand:function(o,r,b,m,n){var h=new RegExp("^(?:"+(r||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=b?[]:(m||this.options.removeFormatAttributes).split(","),j=new dom.Range(this.document),k,e,l,c=function(i){return i.nodeType==1;};function d(v){if(v.nodeType==3||v.tagName.toLowerCase()!="span"){return 0;}if(browser.ie){var t=v.attributes;if(t.length){for(var u=0,s=t.length;u<s;u++){if(t[u].specified){return 0;}}return 1;}}return !v.attributes.length;}function p(x){var i=x.createBookmark();if(x.collapsed){x.enlarge(true);}if(!n){var s=domUtils.findParentByTagName(x.startContainer,"a",true);if(s){x.setStartBefore(s);}s=domUtils.findParentByTagName(x.endContainer,"a",true);if(s){x.setEndAfter(s);}}k=x.createBookmark();t=k.start;while((l=t.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(t,l);domUtils.clearEmptySibling(t);}if(k.end){t=k.end;while((l=t.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(t,l);domUtils.clearEmptySibling(t);}var y=domUtils.getNextDomNode(k.start,false,c),w;while(y){if(y==k.end){break;}w=domUtils.getNextDomNode(y,true,c);if(!dtd.$empty[y.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(y)){if(h.test(y.tagName)){if(b){domUtils.removeStyle(y,b);if(d(y)&&b!="text-decoration"){domUtils.remove(y,true);}}else{domUtils.remove(y,true);}}else{if(!dtd.$tableContent[y.tagName]&&!dtd.$list[y.tagName]){domUtils.removeAttributes(y,f);if(d(y)){domUtils.remove(y,true);}}}}y=w;}}var z=k.start.parentNode;if(domUtils.isBlockElm(z)&&!dtd.$tableContent[z.tagName]&&!dtd.$list[z.tagName]){domUtils.removeAttributes(z,f);}z=k.end.parentNode;if(k.end&&domUtils.isBlockElm(z)&&!dtd.$tableContent[z.tagName]&&!dtd.$list[z.tagName]){domUtils.removeAttributes(z,f);}x.moveToBookmark(k).moveToBookmark(i);var t=x.startContainer,v,u=x.collapsed;while(t.nodeType==1&&domUtils.isEmptyNode(t)&&dtd.$removeEmpty[t.tagName]){v=t.parentNode;x.setStartBefore(t);if(x.startContainer===x.endContainer){x.endOffset--;}domUtils.remove(t);t=v;}if(!u){t=x.endContainer;while(t.nodeType==1&&domUtils.isEmptyNode(t)&&dtd.$removeEmpty[t.tagName]){v=t.parentNode;x.setEndBefore(t);domUtils.remove(t);t=v;}}}if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var g=0,q;q=this.currentSelectedArr[g++];){j.selectNodeContents(q);p(j);}j.selectNodeContents(this.currentSelectedArr[0]).select();}else{j=this.selection.getRange();p(j);j.select();}},queryCommandState:function(){return this.highlight?-1:0;}};};