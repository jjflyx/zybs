(function(a){a.ligerMenu=function(b){return a.ligerui.run.call(null,"ligerMenu",arguments);};a.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:true};a.ligerMethos.Menu={};a.ligerui.controls.Menu=function(b){a.ligerui.controls.Menu.base.constructor.call(this,null,b);};a.ligerui.controls.Menu.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Menu";},__idPrev:function(){return"Menu";},_extendMethods:function(){return a.ligerMethos.Menu;},_render:function(){var b=this,c=this.options;b.menuItemCount=0;b.menus={};b.menu=b.createMenu();b.element=b.menu[0];b.menu.css({top:c.top,left:c.left,width:c.width});c.items&&a(c.items).each(function(d,e){b.addItem(e);});b.createIframe(b.menu);a(document).bind("click.menu",function(){for(var d in b.menus){var e=b.menus[d];if(!e){return;}e.hide();if(e.shadow){e.shadow.hide();}b.hideIframe(e);}});b.set(c);},show:function(b,e){var c=this,d=this.options;if(e==undefined){e=c.menu;}if(b&&b.left!=undefined){e.css({left:b.left});}if(b&&b.top!=undefined){e.css({top:b.top});}e.show();c.updateShadow(e);c.showIframe(e);},updateShadow:function(d){var b=this,c=this.options;if(!c.shadow){return;}d.shadow.css({left:d.css("left"),top:d.css("top"),width:d.outerWidth(),height:d.outerHeight()});if(d.is(":visible")){d.shadow.show();}else{d.shadow.hide();}},hide:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu;}b.hideAllSubMenu(d);d.hide();b.updateShadow(d);b.hideIframe(d);},hideIframe:function(c){var b=c.attr("memuId");a("iframe.l_menu_frame[iframeId='"+b+"']").hide();},showIframe:function(d){var b=d.attr("memuId");var c=a("iframe.l_menu_frame[iframeId='"+b+"']");c.show();c.css({top:d.css("top"),left:d.css("left"),width:d.width()+2,height:d.height()+5});},toggle:function(){var b=this,c=this.options;b.menu.toggle();b.updateShadow(b.menu);},removeItem:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).remove();},setEnabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).removeClass("l-menu-item-disable");},setDisabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).addClass("l-menu-item-disable");},isEnable:function(c){var b=this,d=this.options;return !a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).hasClass("l-menu-item-disable");},getItemCount:function(){var b=this,c=this.options;return a("> .l-menu-item",b.menu.items).length;},addItem:function(e,h){var d=this,f=this.options;if(!e){return;}if(h==undefined){h=d.menu;}if(e.line){h.items.append('<div class="l-menu-item-line"></div>');return;}var b=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>');var c=a("> .l-menu-item",h.items).length;h.items.append(b);b.attr("ligeruimenutemid",++d.menuItemCount);e.id&&b.attr("menuitemid",e.id);e.text&&a(">.l-menu-item-text:first",b).html(e.text);e.icon&&b.prepend('<div class="l-menu-item-icon l-icon-'+e.icon+'"></div>');if(e.disable||e.disabled){b.addClass("l-menu-item-disable");}if(e.children){b.append('<div class="l-menu-item-arrow"></div>');var j=d.createMenu(b.attr("ligeruimenutemid"));d.menus[b.attr("ligeruimenutemid")]=j;j.width(f.width);j.hover(null,function(){if(!j.showedSubMenu){d.hide(j);}});a(e.children).each(function(){d.addItem(this,j);});d.createIframe(j);}e.click&&b.click(function(){if(a(this).hasClass("l-menu-item-disable")){return;}e.click(e,c);});e.dblclick&&b.dblclick(function(){if(a(this).hasClass("l-menu-item-disable")){return;}e.dblclick(e,c);});var i=a("> .l-menu-over:first",h);b.hover(function(){if(a(this).hasClass("l-menu-item-disable")){return;}var k=a(this).offset().top;var l=k-h.offset().top;i.css({top:l});d.hideAllSubMenu(h);if(e.children){var g=a(this).attr("ligeruimenutemid");if(!g){return;}if(d.menus[g]){d.show({top:k,left:a(this).offset().left+a(this).width()-5},d.menus[g]);h.showedSubMenu=true;}}},function(){if(a(this).hasClass("l-menu-item-disable")){return;}var g=a(this).attr("ligeruimenutemid");if(e.children){var g=a(this).attr("ligeruimenutemid");if(!g){return;}}});},hideAllSubMenu:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu;}a("> .l-menu-item",d.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var e=a(this).attr("ligeruimenutemid");if(!e){return;}b.menus[e]&&b.hide(b.menus[e]);b.hideIframe(b.menus[e]);}});d.showedSubMenu=false;},createIframe:function(d){var c=a('<iframe  frameborder="0" class="l_menu_frame" style="position:absolute;z-index:1;display:none;"></iframe>');var b=d.attr("memuId");c.css({left:d.left,top:d.top,width:d.width()+2,height:d.height()+5});c.attr("iframeId",b);c.appendTo("body");},createMenu:function(c){var b=this,d=this.options;var e=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');c&&e.attr("ligeruiparentmenuitemid",c);e.items=a("> .l-menu-inner:first",e);e.appendTo("body");if(d.shadow){e.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(e);b.updateShadow(e);}e.hover(null,function(){if(!e.showedSubMenu){a("> .l-menu-over:first",e).css({top:-24});}});if(c){b.menus[c]=e;}else{b.menus[0]=e;}if(e.attr("memuId")==undefined){e.attr("memuId",new Date().getTime());}return e;}});a.ligerui.controls.Menu.prototype.setEnable=a.ligerui.controls.Menu.prototype.setEnabled;a.ligerui.controls.Menu.prototype.setDisable=a.ligerui.controls.Menu.prototype.setDisabled;})(jQuery);