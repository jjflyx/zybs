(function(b){var a=b.ligerui;a.windowCount=0;b.ligerWindow=function(c){return a.run.call(null,"ligerWindow",arguments,{isStatic:true});};b.ligerWindow.show=function(c){return b.ligerWindow(c);};b.ligerDefaults.Window={showClose:true,showMax:true,showToggle:true,showMin:true,title:"window",load:false,onLoaded:null,modal:false};b.ligerMethos.Window={};a.controls.Window=function(c){a.controls.Window.base.constructor.call(this,null,c);};a.controls.Window.ligerExtend(a.core.Win,{__getType:function(){return"Window";},__idPrev:function(){return"Window";},_extendMethods:function(){return b.ligerMethos.Window;},_render:function(){var f=this,j=this.options;f.window=b('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>');f.element=f.window[0];f.window.content=b(".l-window-content",f.window);f.window.header=b(".l-window-header",f.window);f.window.buttons=b(".l-window-header-buttons:first",f.window);if(j.url){if(j.load){f.window.content.load(j.url,function(){f.trigger("loaded");});f.window.content.addClass("l-window-content-scroll");}else{var d=b("<iframe frameborder='0' src='"+j.url+"'></iframe>");var c="ligeruiwindow"+a.windowCount++;if(j.name){c=j.name;}d.attr("name",c).attr("id",c);j.framename=c;d.appendTo(f.window.content);f.iframe=d;}}else{if(j.content){var e=b("<div>"+j.content+"</div>");e.appendTo(f.window.content);}else{if(j.target){f.window.content.append(j.target);j.target.show();}}}this.mask();f.active();b("body").append(f.window);f.set({width:j.width,height:j.height});var i=0;var h=0;if(j.left!=null){i=j.left;}else{j.left=i=0.5*(b(window).width()-f.window.width());}if(j.top!=null){h=j.top;}else{j.top=h=0.5*(b(window).height()-f.window.height())+b(window).scrollTop()-10;}if(i<0){j.left=i=0;}if(h<0){j.top=h=0;}f.set(j);j.framename&&b(">iframe",f.window.content).attr("name",j.framename);if(!j.showToggle){b(".l-window-toggle",f.window).remove();}if(!j.showMax){b(".l-window-max",f.window).remove();}if(!j.showClose){b(".l-window-close",f.window).remove();}f._saveStatus();if(b.fn.ligerDrag){f.draggable=f.window.drag=f.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){f.active();},onStopDrag:function(){f._saveStatus();},animate:false});}if(b.fn.ligerResizable){f.resizeable=f.window.resizable=f.window.ligerResizable({onStartResize:function(){f.active();b(".l-window-max",f.window).removeClass("l-window-regain");},onStopResize:function(m,l){var k=0;var g=0;if(!isNaN(parseInt(f.window.css("top")))){k=parseInt(f.window.css("top"));}if(!isNaN(parseInt(f.window.css("left")))){g=parseInt(f.window.css("left"));}if(m.diffTop){f.window.css({top:k+m.diffTop});}if(m.diffLeft){f.window.css({left:g+m.diffLeft});}if(m.newWidth){f.window.width(m.newWidth);}if(m.newHeight){f.window.content.height(m.newHeight-28);}f._saveStatus();return false;}});f.window.append("<div class='l-btn-nw-drop'></div>");}b(".l-window-toggle",f.window).click(function(){if(b(this).hasClass("l-window-toggle-close")){f.collapsed=false;b(this).removeClass("l-window-toggle-close");}else{f.collapsed=true;b(this).addClass("l-window-toggle-close");}f.window.content.slideToggle();}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true);}},function(){if(f.window.drag){f.window.drag.set("disabled",false);}});b(".l-window-close",f.window).click(function(){if(f.trigger("close")==false){return false;}f.window.hide();a.win.removeTask(f);}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true);}},function(){if(f.window.drag){f.window.drag.set("disabled",false);}});b(".l-window-max",f.window).click(function(){if(b(this).hasClass("l-window-regain")){if(f.trigger("regain")==false){return false;}f.window.width(f._width).css({left:f._left,top:f._top});f.window.content.height(f._height-28);b(this).removeClass("l-window-regain");}else{if(f.trigger("max")==false){return false;}f.window.width(b(window).width()-2).css({left:0,top:0});f.window.content.height(b(window).height()-28).show();b(this).addClass("l-window-regain");}});},_saveStatus:function(){var c=this;c._width=c.window.width();c._height=c.window.height();var e=0;var d=0;if(!isNaN(parseInt(c.window.css("top")))){e=parseInt(c.window.css("top"));}if(!isNaN(parseInt(c.window.css("left")))){d=parseInt(c.window.css("left"));}c._top=e;c._left=d;},min:function(){this.window.hide();this.minimize=true;this.actived=false;},_setShowMin:function(d){var c=this,e=this.options;if(d){if(!c.winmin){c.winmin=b('<div class="l-window-min"></div>').prependTo(c.window.buttons).click(function(){c.min();});a.win.addTask(c);}}else{if(c.winmin){c.winmin.remove();c.winmin=null;}}},_setLeft:function(c){if(c!=null){this.window.css({left:c});}},_setTop:function(c){if(c!=null){this.window.css({top:c});}},_setWidth:function(c){if(c>0){this.window.width(c);}},_setHeight:function(c){if(c>28){this.window.content.height(c-28);}},_setTitle:function(c){if(c){b(".l-window-header-inner",this.window.header).html(c);}},_setUrl:function(c){var d=this,e=this.options;e.url=c;if(e.load){d.window.content.html("").load(e.url,function(){if(d.trigger("loaded")==false){return false;}});}else{if(d.jiframe){d.jiframe.attr("src",e.url);}}},hide:function(){var c=this,d=this.options;this.unmask();this.window.hide();},show:function(){var c=this,d=this.options;this.mask();this.window.show();},remove:function(){var c=this,d=this.options;this.unmask();this.window.remove();},active:function(){var e=this,i=this.options;if(e.minimize){var d=e._width,c=e._height,h=e._left,f=e._top;if(e.maximum){d=b(window).width();c=b(window).height();h=f=0;if(a.win.taskbar){c-=a.win.taskbar.outerHeight();if(a.win.top){f+=a.win.taskbar.outerHeight();}}}e.set({width:d,height:c,left:h,top:f});}e.actived=true;e.minimize=false;a.win.setFront(e);e.show();a.win.setFront(this);},setUrl:function(c){return _setUrl(c);}});})(jQuery);